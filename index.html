<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Atmlib by TEAMarg</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Atmlib</h1>
        <h2>Arduboy Tracker Music Library</h2>
        <a href="https://github.com/TEAMarg/ATMlib" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="atmlib" class="anchor" href="#atmlib" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>ATMlib</h1>

<p>ATMlib stands for <strong>Arduboy Tracker Music</strong> and is based on <a href="https://github.com/stg/Squawk" title="Squawk Github Page"><em><strong>Squawk</strong></em></a> a minimalistic 8-bit software synthesizer &amp; playroutine library for Arduino, created by Davey Taylor aka STG.</p>

<p>While <em>Squawk</em> provides a very nice synth, it wasn't optimized for a small footprint. Songs are not very efficient in size, so Joeri Gantois aka JO3RI asked Davey to help him work on a new songformat and so ATMlib was born.</p>

<p>Contributers:</p>

<ul>
<li>Davey Taylor - ATMsynth</li>
<li>Joeri Gantois - effects</li>
</ul>

<h3>
<a id="filearray-format-description" class="anchor" href="#filearray-format-description" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>FILE/ARRAY FORMAT DESCRIPTION</h3>

<table>
<thead>
<tr>
<th><strong>Section</strong></th>
<th><strong>Field</strong></th>
<th><strong>Type</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Track table</strong></td>
<td></td>
<td></td>
<td><strong>Number of tracks and their addresses</strong></td>
</tr>
<tr>
<td></td>
<td>Track count</td>
<td>UBYTE (8-bits)</td>
<td>Number of tracks in the file/array</td>
</tr>
<tr>
<td></td>
<td>Address track 1</td>
<td>UWORD (16-bits)</td>
<td>Location in the file/array for track 1</td>
</tr>
<tr>
<td></td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td></td>
<td>Address track <em><strong>N</strong></em>
</td>
<td>UWORD (16-bits)</td>
<td>Location in the file/array for track <em><strong>N</strong> (0 … 255)</em>
</td>
</tr>
<tr>
<td> </td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Channel entry tracks</strong></td>
<td></td>
<td></td>
<td><strong>For each channel, track to start with</strong></td>
</tr>
<tr>
<td></td>
<td>Channel 0 track</td>
<td>UBYTE (8-bits)</td>
<td>Starting track index for channel 0</td>
</tr>
<tr>
<td></td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td></td>
<td>Channel 3 track</td>
<td>UBYTE (8-bits)</td>
<td>Starting track index for channel 3</td>
</tr>
<tr>
<td> </td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Track 0</strong></td>
<td></td>
<td></td>
<td><strong>Commands and parameters for track 0</strong></td>
</tr>
<tr>
<td></td>
<td>Command 0</td>
<td>UBYTE (8-bits)</td>
<td>See command list</td>
</tr>
<tr>
<td></td>
<td>
<em>and its</em> Parameters</td>
<td>none/variable</td>
<td><em>See <strong>parameter list</strong> for each command</em></td>
</tr>
<tr>
<td></td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr>
<td></td>
<td>Command N</td>
<td>UBYTE (8-bits)</td>
<td></td>
</tr>
<tr>
<td></td>
<td>
<em>and its</em> Parameters</td>
<td>none/variable</td>
<td></td>
</tr>
<tr>
<td><strong>…</strong></td>
<td><strong>…</strong></td>
<td><strong>…</strong></td>
<td><strong>…</strong></td>
</tr>
<tr>
<td><strong>Track <em>N</em></strong></td>
<td></td>
<td></td>
<td>
<strong>Commands and parameters for track <em>N</em></strong> <em>(0-255)</em>
</td>
</tr>
</tbody>
</table>

<h3>
<a id="command-list" class="anchor" href="#command-list" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>COMMAND LIST</h3>

<table>
<thead>
<tr>
<th><strong>Command (<em>X</em>)</strong></th>
<th><strong>Parameter</strong></th>
<th><strong>Type</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td></td>
<td></td>
<td>Stop playing</td>
</tr>
<tr>
<td> </td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>1 …  63</td>
<td></td>
<td></td>
<td>Start playing note <em>[<strong>X</strong>]</em> where 1 is a C1. See <a href="./extras/frequencyToTone.md" title="Frequency to Tone table">Frequency to Tone</a>
</td>
</tr>
<tr>
<td> </td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>64 … 159</td>
<td></td>
<td></td>
<td>Configure effects (fx)</td>
</tr>
<tr>
<td></td>
<td><em>See <strong>fx list</strong></em></td>
<td>none/variable</td>
<td>Effect is <em>[<strong>X</strong> - 64]</em>
</td>
</tr>
<tr>
<td> </td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>160 … 223</td>
<td></td>
<td></td>
<td>Delay for <em>[<strong>X</strong> - 159]</em> ticks</td>
</tr>
<tr>
<td> </td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>224</td>
<td></td>
<td></td>
<td>Long delay</td>
</tr>
<tr>
<td></td>
<td>Ticks (<em><strong>Y</strong></em>)</td>
<td>VLE (8/16/24-bits)</td>
<td>Delay for <em>[<strong>Y</strong> + 64]</em> ticks</td>
</tr>
<tr>
<td> </td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><del>225 … 251</del></td>
<td></td>
<td></td>
<td><del>RESERVED</del></td>
</tr>
<tr>
<td> </td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>252</td>
<td></td>
<td></td>
<td>Call/run/goto specified track</td>
</tr>
<tr>
<td></td>
<td>Track</td>
<td>UBYTE (8-bits)</td>
<td>Track index</td>
</tr>
<tr>
<td> </td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>253</td>
<td></td>
<td></td>
<td>Repeated call/run/goto specified track</td>
</tr>
<tr>
<td></td>
<td>Loop count (<em><strong>Y</strong></em>)</td>
<td>UBYTE (8-bits)</td>
<td>Repeat <em>[<strong>Y</strong> + 2]</em> times (total)</td>
</tr>
<tr>
<td></td>
<td>Track</td>
<td>UBYTE (8-bits)</td>
<td>Track index</td>
</tr>
<tr>
<td> </td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>254</td>
<td></td>
<td></td>
<td>Return/end of track marker</td>
</tr>
<tr>
<td> </td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>255</td>
<td></td>
<td></td>
<td>Binary data</td>
</tr>
<tr>
<td></td>
<td>Length</td>
<td>VLE (8/16/24-bits)</td>
<td>Length in bytes of data to follow</td>
</tr>
<tr>
<td></td>
<td>Data</td>
<td>variable</td>
<td>Binary data chunk (notify host application)</td>
</tr>
</tbody>
</table>

<h3>
<a id="fx-list" class="anchor" href="#fx-list" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>FX LIST</h3>

<table>
<thead>
<tr>
<th><strong>Effect</strong></th>
<th><strong>Parameter</strong></th>
<th><strong>Type</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>64+0<br>64<br>0x40</strong></td>
<td>set Volume (<em><strong>X</strong></em>)</td>
<td>UBYTE (8-bit)</td>
<td>Set volume to <em>[<strong>X</strong>]</em>. <br> <strong><em>Note:</em></strong><br> If the combined volume of all channels exceed 255 there may be rollover distortion. This should not be disallowed, as it may be usesful as an effects hack for the musician. There should however be a non-interfering warning when a musician enters a value above 63 for ch 1-3 or 32 for ch 4 (noise). ch 4 the volume is counted double, so 32 is actually 64</td>
</tr>
<tr>
<td><strong>64+1<br>65<br>0x41</strong></td>
<td>slide Volume ON (<em><strong>X</strong></em>)</td>
<td>UBYTE (8-bit)</td>
<td>Slide the volume with an amount (positive or negative) of <em>[<strong>X</strong>]</em> for every tick.<br> <strong><em>Note:</em></strong><br>  This results in a fade-in or fade-out effect. There should be a non-interfering warning when sliding would result in exceeding 63 for ch 1-3 and 32 for ch 4.</td>
</tr>
<tr>
<td><strong>64+2<br>66<br>0x42</strong></td>
<td>slide Volume ON advanced (<em><strong>X</strong></em>) (<em><strong>Y</strong></em>)</td>
<td>UBYTE (8-bit) UBYTE (8-bit)</td>
<td>Slide the volume with an amount (positive or negative) of <em>[<strong>X</strong>]</em> for every [<em><strong>Y</strong></em>] ticks.<br>
</td>
</tr>
<tr>
<td><strong>64+3<br>67<br>0x43</strong></td>
<td>slide Volume OFF</td>
<td></td>
<td>stops the volume slide</td>
</tr>
<tr>
<td><strong>64+4<br>68<br>0x44</strong></td>
<td>slide Frequency ON (<em><strong>X</strong></em>)</td>
<td>UBYTE (8-bit)</td>
<td>Slide the frequency with an amount (positive or negative) of <em>[<strong>X</strong>]</em> for every tick.<br> <strong><em>Note:</em></strong><br> The amount of slide is limited between -127 to 127</td>
</tr>
<tr>
<td><strong>64+5<br>69<br>0x45</strong></td>
<td>slide Frequency ON advanced (<em><strong>X</strong></em>) (<em><strong>Y</strong></em>)</td>
<td>UBYTE (8-bit) UBYTE (8-bit)</td>
<td>Slide the frequency with an amount (positive or negative) of <em>[<strong>X</strong>]</em> for every [<em><strong>Y</strong></em>] ticks.<br> <strong><em>Note:</em></strong> The amount of slide and ticks devider is limited between -127 to 127</td>
</tr>
<tr>
<td><strong>64+6<br>70<br>0x46</strong></td>
<td>slide Frequency OFF</td>
<td></td>
<td>stops the frequency slide</td>
</tr>
<tr>
<td><strong>64+7<br>71<br>0x47</strong></td>
<td>set Arpeggio (<em><strong>X</strong></em>)(<em><strong>Y</strong></em>)</td>
<td>UBYTE (8-bit) UBYTE (8-bit)</td>
<td>Next to the current playing note, play a second and third note <em>[<strong>X</strong>]</em> for every <em>[<strong>Y</strong>]</em> ticks. <em>[<strong>X</strong>]</em> includes 2 parameters: AAAABBBB, where AAAA = base + amount to second note and BBBB = second note + amount to third note.<br> <em>[<strong>Y</strong>]</em> includes 4 parameters: FEDttttt, where F = reserved, E = toggle no third note, D = toggle retrigger, ttttt = tick amount.<br><strong><em>Note:</em></strong><br>Arpeggio is used for playing 3 notes out of a chord indivually</td>
</tr>
<tr>
<td><strong>64+8<br>72<br>0x48</strong></td>
<td>Arpeggio OFF</td>
<td></td>
<td>stops the arpeggio</td>
</tr>
<tr>
<td><strong>64+9<br>73<br>0x49</strong></td>
<td>set Retriggering (<em><strong>X</strong></em>)</td>
<td>UBYTE (8-bit)</td>
<td>Noise channel consists of white noise. By setting retriggering <em>[<strong>X</strong>]</em> it swithes the entrypoint at a given speed. <em>[<strong>X</strong>]</em>  includes 2 parameters: AAAAAABB , where AAAAAA = entry point and BB = speed (0 = fastest, 1 = faster , 2 = fast)</td>
</tr>
<tr>
<td><strong>64+10<br>74<br>0x4A</strong></td>
<td>Retriggering off</td>
<td></td>
<td>stops the retriggering for the noise on channel 3</td>
</tr>
<tr>
<td><strong>64+11<br>75<br>0x4B</strong></td>
<td>add Transposition (<em><strong>X</strong></em>)</td>
<td>UBYTE (8-bit)</td>
<td>shifts the played notes by adding <em>[<strong>X</strong>]</em> to the existing transposition for all playing notes.<br><strong><em>Note:</em></strong><br> The amount of shift is limited between -127 to 127. However there should be a non-interfering warning when transposing would result in exceeding 63 or get lower than 0</td>
</tr>
<tr>
<td><strong>64+12<br>76<br>0x4C</strong></td>
<td>set Transposition (<em><strong>X</strong></em>)</td>
<td>UBYTE (8-bit)</td>
<td>shifts the played notes by setting the transposition to [<strong>X</strong>]* for all playing notes.<br><strong><em>Note:</em></strong><br> The amount of shift is limited between -127 to 127. However there should be a non-interfering warning when transposing would result in exceeding 63 or get lower than 0</td>
</tr>
<tr>
<td><strong>64+13<br>77<br>0x4D</strong></td>
<td>Transposition OFF</td>
<td></td>
<td>stops the transposition</td>
</tr>
<tr>
<td><strong>64+14<br>78<br>0x4E</strong></td>
<td>set Tremolo (<em><strong>X</strong></em>)(<em><strong>Y</strong></em>)</td>
<td>UBYTE (8-bit) UBYTE (8-bit)</td>
<td>
<em>[<strong>X</strong>]</em> sets Depth.<br> <em>[<strong>Y</strong>]</em> includes 4 parameters: RxxBBBBB R = Retrig, x = reserved , B = rate<br><strong><em>Note:</em></strong><br> <strong><em>Note:</em></strong> Tremolo and Vibrato can <strong>NOT</strong> be combined in the same stack</td>
</tr>
<tr>
<td><strong>64+15<br>79<br>0x4F</strong></td>
<td>Tremolo OFF</td>
<td></td>
<td>stops the tremolo or vibrato</td>
</tr>
<tr>
<td><strong>64+16<br>80<br>0x50</strong></td>
<td>set Vibrato (<em><strong>X</strong></em>)(<em><strong>Y</strong></em>)</td>
<td>UBYTE (8-bit) UBYTE (8-bit)</td>
<td>
<em>[<strong>X</strong>]</em> sets Depth.<br> <em>[<strong>Y</strong>]</em> includes 4 parameters: RxxBBBBB R = Retrig, x = reserved , B = rate<br><strong><em>Note:</em></strong><br> <strong><em>Note:</em></strong> Tremolo and Vibrato can <strong>NOT</strong> be combined in the same stack</td>
</tr>
<tr>
<td><strong>64+17<br>81<br>0x51</strong></td>
<td>Vibrato OFF</td>
<td></td>
<td>stops the vibrato</td>
</tr>
<tr>
<td><strong>64+18<br>82<br>0x52</strong></td>
<td>SET Glissando (<em><strong>X</strong></em>)</td>
<td>UBYTE (8-bit)</td>
<td>
<em>[<strong>X</strong>]</em> includes 2 parameters: Vttttttt  V = value ( 0 = go 1 note up, 1 = go 1 note down) and t = amount of ticks, between each step</td>
</tr>
<tr>
<td><strong>64+19<br>83<br>0x53</strong></td>
<td>Glissando OFF</td>
<td></td>
<td>stops the Glissando</td>
</tr>
<tr>
<td><strong>64+20<br>84<br>0x54</strong></td>
<td>SET Note Cut (<em><strong>X</strong></em>)</td>
<td>UBYTE (8-bit)</td>
<td>
<em>[<strong>X</strong>]</em> sets the equal amount of ticks between note ON and OFF</td>
</tr>
<tr>
<td><strong>64+21<br>85<br>0x55</strong></td>
<td>Note Cut Off</td>
<td></td>
<td>stops the Note Cut</td>
</tr>
<tr>
<td></td>
<td> </td>
<td> </td>
<td></td>
</tr>
<tr>
<td><strong>64+93<br>157<br>0x9D</strong></td>
<td> SET song tempo (<em><strong>X</strong></em>)</td>
<td>UBYTE (8-bit)</td>
<td>
<em>[<strong>X</strong>]</em> (re-)sets the tempo of the song. Standard is 25. Value should be between 0 - 128</td>
</tr>
<tr>
<td><strong>64+94<br>158<br>0x9E</strong></td>
<td>GOTO advanced (<em><strong>W</strong></em>)(<em><strong>X</strong></em>)(<em><strong>Y</strong></em>)(<em><strong>Z</strong></em>)</td>
<td>UBYTE (8-bit) UBYTE (8-bit) UBYTE (8-bit) UBYTE (8-bit)</td>
<td>for channel <strong>0</strong> go to track <strong>W</strong><br>for channel <strong>1</strong> go to track <strong>X</strong><br>for channel <strong>2</strong> go to track <strong>Y</strong><br>for channel <strong>3</strong> go to track <strong>Z</strong><br><strong><em>Note:</em></strong> handy command for having an intro and a repeating song part</td>
</tr>
<tr>
<td><strong>64+95<br>159<br>0x9F</strong></td>
<td>Stop current channel</td>
<td></td>
<td>channel is no longer being processed<br><strong><em>Note:</em></strong> if all channels have reached STOP, the song ends</td>
</tr>
<tr>
<td><del>TBD</del></td>
<td><del>TBD</del></td>
<td><del>TBD</del></td>
<td><del>TBD</del></td>
</tr>
</tbody>
</table>

<h4>
<a id="thoughts-on-effects" class="anchor" href="#thoughts-on-effects" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Thoughts on effects:</h4>

<p><strong>Note:</strong> These are the primitives to be implemented in the playroutine effects processor. Most will have several effect command numbers associated with them for various aspects of the same primitive. Effects can be combined but not stacked, but some combinations may have undesired/interesting interference.</p>

<ul>
<li>Volume slide: a gradual increasing or decreasing of the volume.</li>
<li>Frequency slide: a gradual increasing or decreasing of the <a href="https://en.wikipedia.org/wiki/Frequency" title="frequency wikipedia">frequency</a>.</li>
<li>Arpeggio: a group of <a href="https://en.wikipedia.org/wiki/Musical_note" title="note wikipedia">notes</a> which are rapidly and automatically played one after the other.</li>
<li>Retriggering (on <a href="https://en.wikipedia.org/wiki/Musical_note" title="note wikipedia">note</a> or by automation): oscillators are restarted either automatically or at the start of each new note.</li>
<li>Transposition (also for microtonals): play <a href="https://en.wikipedia.org/wiki/Musical_note" title="note wikipedia">notes</a> in a different key, or fine tune notes to provide microtonals; frequencies that are in between notes.</li>
<li>Tremolo: a slight, rapid and regular fluctuation in the amplitude/volume of a <a href="https://en.wikipedia.org/wiki/Musical_note" title="note wikipedia">note</a>.</li>
<li>Vibrato: a slight, rapid and regular fluctuation in the <a href="https://en.wikipedia.org/wiki/Pitch_(music)" title="pitch wikipedia">pitch</a> of a <a href="https://en.wikipedia.org/wiki/Musical_note" title="note wikipedia">note</a>.</li>
<li>Glissando: controls if and how a gradual frequency slide "snaps" to adjacent notes.</li>
<li>Note cut (with delay and automation): provides a method to stutter and adjust note timing.</li>
</ul>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/TEAMarg/ATMlib/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/TEAMarg/ATMlib/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/TEAMarg/ATMlib"></a> is maintained by <a href="https://github.com/TEAMarg">TEAMarg</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
